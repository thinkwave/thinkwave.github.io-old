(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{514:function(e,s,t){"use strict";t.r(s);var a=t(4),r=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("p",[t("a",{attrs:{href:"https://github.com/Grokzen/docker-redis-cluster",target:"_blank",rel:"noopener noreferrer"}},[e._v("docker-compose"),t("OutboundLink")],1),e._v("로 Redis Cluster를 쉽게 구동할 수 있습니다. 간단하게 테스트 해 보실분은 docker-redis-cluster로 하시길 추천합니다.")]),e._v(" "),t("h2",{attrs:{id:"cluster-구성"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cluster-구성"}},[e._v("#")]),e._v(" Cluster 구성")]),e._v(" "),t("p",[e._v("Node 3대와 Primary Cluster, Secondary Cluster, Third Cluster 로 구성합니다.")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("Cluster")]),e._v(" "),t("th",{staticStyle:{"text-align":"center"}},[e._v("Node #01")]),e._v(" "),t("th",{staticStyle:{"text-align":"center"}},[e._v("Node #02")]),e._v(" "),t("th",{staticStyle:{"text-align":"center"}},[e._v("Node #03")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("Cluster #1")]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[t("strong",[e._v("redis-c1-master(6379)")])]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[e._v("redis-c1-slave1(6379)")]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[e._v("redis-c1-slave2(6379)")])]),e._v(" "),t("tr",[t("td",[e._v("Cluster #2")]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[e._v("redis-c2-slave1(6380)")]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[t("strong",[e._v("redis-c2-master(6380)")])]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[e._v("redis-c2-slave2(6380)")])]),e._v(" "),t("tr",[t("td",[e._v("Cluster #3")]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[e._v("redis-c3-slave1(6381)")]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[e._v("redis-c3-slave2(6381)")]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[t("strong",[e._v("redis-c3-master(6381)")])])])])]),e._v(" "),t("h2",{attrs:{id:"docker로-redis-설치"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker로-redis-설치"}},[e._v("#")]),e._v(" Docker로 Redis 설치")]),e._v(" "),t("h3",{attrs:{id:"network-구성"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#network-구성"}},[e._v("#")]),e._v(" Network 구성")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker network create redis-cluster-net\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("h3",{attrs:{id:"node-1"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#node-1"}},[e._v("#")]),e._v(" Node #1")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker run -d --name redis-c1-master --network redis-cluster-net -v /tmp/redis/c1-master:/data redis:5.0 redis-server --port 6379:6379 --cluster-enabled yes --cluster-config-file node.conf --cluster-node-timeout 5000 --bind 0.0.0.0\ndocker run -d --name redis-c2-slave1 --network redis-cluster-net -v /tmp/redis/c2-slave1:/data redis:5.0 redis-server --port 6380:6380 --cluster-enabled yes --cluster-config-file node.conf --cluster-node-timeout 5000 --bind 0.0.0.0 --appendonly yes\ndocker run -d --name redis-c3-slave1 --network redis-cluster-net -v /tmp/redis/c3-slave1:/data redis:5.0 redis-server --port 6381:6381 --cluster-enabled yes --cluster-config-file node.conf --cluster-node-timeout 5000 --bind 0.0.0.0 --appendonly yes\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])]),t("h3",{attrs:{id:"node-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#node-2"}},[e._v("#")]),e._v(" Node #2")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker run -d --name redis-c1-slave1 --network redis-cluster-net -v /tmp/redis/c1-slave1:/data redis:5.0 redis-server --port 6379:6379 --cluster-enabled yes --cluster-config-file node.conf --cluster-node-timeout 5000 --bind 0.0.0.0\ndocker run -d --name redis-c2-master --network redis-cluster-net -v /tmp/redis/c2-master:/data redis:5.0 redis-server --port 6380:6380 --cluster-enabled yes --cluster-config-file node.conf --cluster-node-timeout 5000 --bind 0.0.0.0 --appendonly yes\ndocker run -d --name redis-c3-slave2 --network redis-cluster-net -v /tmp/redis/c3-slave2:/data redis:5.0 redis-server --port 6381:6381 --cluster-enabled yes --cluster-config-file node.conf --cluster-node-timeout 5000 --bind 0.0.0.0 --appendonly yes\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])]),t("h3",{attrs:{id:"node-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#node-3"}},[e._v("#")]),e._v(" Node #3")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker run -d --name redis-c1-slave2 --network redis-cluster-net -v /tmp/redis/c1-slave2:/data redis:5.0 redis-server --port 6379:6379 --cluster-enabled yes --cluster-config-file node.conf --cluster-node-timeout 5000 --bind 0.0.0.0\ndocker run -d --name redis-c2-slave2 --network redis-cluster-net -v /tmp/redis/c2-slave2:/data redis:5.0 redis-server --port 6380:6380 --cluster-enabled yes --cluster-config-file node.conf --cluster-node-timeout 5000 --bind 0.0.0.0 --appendonly yes\ndocker run -d --name redis-c3-master --network redis-cluster-net -v /tmp/redis/c3-master:/data redis:5.0 redis-server --port 6381:6381 --cluster-enabled yes --cluster-config-file node.conf --cluster-node-timeout 5000 --bind 0.0.0.0 --appendonly yes\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])]),t("blockquote",[t("p",[t("code",[e._v("--appendonly yes")]),e._v("는 Master는 메모리 사용으로 생략, Slave는 Disk 사용")])]),e._v(" "),t("h2",{attrs:{id:"redis-cli로-cluster-구성"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#redis-cli로-cluster-구성"}},[e._v("#")]),e._v(" Redis Cli로 Cluster 구성")]),e._v(" "),t("h3",{attrs:{id:"컨테이너-ip-확인"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#컨테이너-ip-확인"}},[e._v("#")]),e._v(" 컨테이너 IP 확인")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker network inspect redis-cluster-net\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("172.18.0.2:6379 172.18.0.6:6380 172.18.0.10:6381\n172.18.0.5:6379 172.18.0.8:6379 172.18.0.3:6380 172.18.0.9:6380 172.18.0.4:6381 172.18.0.7:6381")]),e._v(" "),t("h3",{attrs:{id:"redis-cli로-cluster-구성하기"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#redis-cli로-cluster-구성하기"}},[e._v("#")]),e._v(" Redis cli로 Cluster 구성하기")]),e._v(" "),t("p",[t("code",[e._v("yes")]),e._v("만 하면 자동으로 Cluster를 구성해 줍니다.")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("--cluster create")]),e._v(" Auto Shading 지원")])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker run -i --rm --network host redis:5.0 redis-cli --cluster create 172.18.0.2:6379 172.18.0.6:6380 172.18.0.10:6381 172.18.0.5:6379 172.18.0.8:6379 172.18.0.3:6380 172.18.0.9:6380 172.18.0.4:6381 172.18.0.7:6381 --cluster-replicas 2\n\n>>> Performing hash slots allocation on 9 nodes...\nMaster[0] -> Slots 0 - 5460\nMaster[1] -> Slots 5461 - 10922\nMaster[2] -> Slots 10923 - 16383\nAdding replica 172.18.0.8:6379 to 172.18.0.2:6379\nAdding replica 172.18.0.3:6380 to 172.18.0.2:6379\nAdding replica 172.18.0.9:6380 to 172.18.0.6:6380\nAdding replica 172.18.0.4:6381 to 172.18.0.6:6380\nAdding replica 172.18.0.7:6381 to 172.18.0.10:6381\nAdding replica 172.18.0.5:6379 to 172.18.0.10:6381\nM: 52f7cfb9188d47844dcf101dbee2de6b9e298dad 172.18.0.2:6379\n   slots:[0-5460] (5461 slots) master\nM: fa705026b31e5998ee598bcb80cb1595098739ab 172.18.0.6:6380\n   slots:[5461-10922] (5462 slots) master\nM: b9f65f158db43e5fba99ac5319d697e0be8a240d 172.18.0.10:6381\n   slots:[10923-16383] (5461 slots) master\nS: 5f57caaea20f90b319a76580f27e6c67efbea864 172.18.0.5:6379\n   replicates b9f65f158db43e5fba99ac5319d697e0be8a240d\nS: 16610a8c4b57f22f577b66b77c13bc323b11670a 172.18.0.8:6379\n   replicates 52f7cfb9188d47844dcf101dbee2de6b9e298dad\nS: 8a0a1fd910dbd148ba133cee4140c75f3aca0b14 172.18.0.3:6380\n   replicates 52f7cfb9188d47844dcf101dbee2de6b9e298dad\nS: d786e629e9b6f94e2cfa2b11c796670c6f4e5d36 172.18.0.9:6380\n   replicates fa705026b31e5998ee598bcb80cb1595098739ab\nS: 63e7257b2919d9a4c0c30a33e5b25c18dc05d840 172.18.0.4:6381\n   replicates fa705026b31e5998ee598bcb80cb1595098739ab\nS: 3e9b47448cd3d5f8d3071a59cae5d97dc084bde9 172.18.0.7:6381\n   replicates b9f65f158db43e5fba99ac5319d697e0be8a240d\nCan I set the above configuration? (type 'yes' to accept): yes\n>>> Nodes configuration updated\n>>> Assign a different config epoch to each node\n>>> Sending CLUSTER MEET messages to join the cluster\nWaiting for the cluster to join\n.\n>>> Performing Cluster Check (using node 172.18.0.2:6379)\nM: 52f7cfb9188d47844dcf101dbee2de6b9e298dad 172.18.0.2:6379\n   slots:[0-5460] (5461 slots) master\n   2 additional replica(s)\nS: 63e7257b2919d9a4c0c30a33e5b25c18dc05d840 172.18.0.4:6381\n   slots: (0 slots) slave\n   replicates fa705026b31e5998ee598bcb80cb1595098739ab\nS: 16610a8c4b57f22f577b66b77c13bc323b11670a 172.18.0.8:6379\n   slots: (0 slots) slave\n   replicates 52f7cfb9188d47844dcf101dbee2de6b9e298dad\nS: 3e9b47448cd3d5f8d3071a59cae5d97dc084bde9 172.18.0.7:6381\n   slots: (0 slots) slave\n   replicates b9f65f158db43e5fba99ac5319d697e0be8a240d\nM: b9f65f158db43e5fba99ac5319d697e0be8a240d 172.18.0.10:6381\n   slots:[10923-16383] (5461 slots) master\n   2 additional replica(s)\nS: d786e629e9b6f94e2cfa2b11c796670c6f4e5d36 172.18.0.9:6380\n   slots: (0 slots) slave\n   replicates fa705026b31e5998ee598bcb80cb1595098739ab\nS: 5f57caaea20f90b319a76580f27e6c67efbea864 172.18.0.5:6379\n   slots: (0 slots) slave\n   replicates b9f65f158db43e5fba99ac5319d697e0be8a240d\nS: 8a0a1fd910dbd148ba133cee4140c75f3aca0b14 172.18.0.3:6380\n   slots: (0 slots) slave\n   replicates 52f7cfb9188d47844dcf101dbee2de6b9e298dad\nM: fa705026b31e5998ee598bcb80cb1595098739ab 172.18.0.6:6380\n   slots:[5461-10922] (5462 slots) master\n   2 additional replica(s)\n[OK] All nodes agree about slots configuration.\n>>> Check for open slots...\n>>> Check slots coverage...\n[OK] All 16384 slots covered.\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br"),t("span",{staticClass:"line-number"},[e._v("14")]),t("br"),t("span",{staticClass:"line-number"},[e._v("15")]),t("br"),t("span",{staticClass:"line-number"},[e._v("16")]),t("br"),t("span",{staticClass:"line-number"},[e._v("17")]),t("br"),t("span",{staticClass:"line-number"},[e._v("18")]),t("br"),t("span",{staticClass:"line-number"},[e._v("19")]),t("br"),t("span",{staticClass:"line-number"},[e._v("20")]),t("br"),t("span",{staticClass:"line-number"},[e._v("21")]),t("br"),t("span",{staticClass:"line-number"},[e._v("22")]),t("br"),t("span",{staticClass:"line-number"},[e._v("23")]),t("br"),t("span",{staticClass:"line-number"},[e._v("24")]),t("br"),t("span",{staticClass:"line-number"},[e._v("25")]),t("br"),t("span",{staticClass:"line-number"},[e._v("26")]),t("br"),t("span",{staticClass:"line-number"},[e._v("27")]),t("br"),t("span",{staticClass:"line-number"},[e._v("28")]),t("br"),t("span",{staticClass:"line-number"},[e._v("29")]),t("br"),t("span",{staticClass:"line-number"},[e._v("30")]),t("br"),t("span",{staticClass:"line-number"},[e._v("31")]),t("br"),t("span",{staticClass:"line-number"},[e._v("32")]),t("br"),t("span",{staticClass:"line-number"},[e._v("33")]),t("br"),t("span",{staticClass:"line-number"},[e._v("34")]),t("br"),t("span",{staticClass:"line-number"},[e._v("35")]),t("br"),t("span",{staticClass:"line-number"},[e._v("36")]),t("br"),t("span",{staticClass:"line-number"},[e._v("37")]),t("br"),t("span",{staticClass:"line-number"},[e._v("38")]),t("br"),t("span",{staticClass:"line-number"},[e._v("39")]),t("br"),t("span",{staticClass:"line-number"},[e._v("40")]),t("br"),t("span",{staticClass:"line-number"},[e._v("41")]),t("br"),t("span",{staticClass:"line-number"},[e._v("42")]),t("br"),t("span",{staticClass:"line-number"},[e._v("43")]),t("br"),t("span",{staticClass:"line-number"},[e._v("44")]),t("br"),t("span",{staticClass:"line-number"},[e._v("45")]),t("br"),t("span",{staticClass:"line-number"},[e._v("46")]),t("br"),t("span",{staticClass:"line-number"},[e._v("47")]),t("br"),t("span",{staticClass:"line-number"},[e._v("48")]),t("br"),t("span",{staticClass:"line-number"},[e._v("49")]),t("br"),t("span",{staticClass:"line-number"},[e._v("50")]),t("br"),t("span",{staticClass:"line-number"},[e._v("51")]),t("br"),t("span",{staticClass:"line-number"},[e._v("52")]),t("br"),t("span",{staticClass:"line-number"},[e._v("53")]),t("br"),t("span",{staticClass:"line-number"},[e._v("54")]),t("br"),t("span",{staticClass:"line-number"},[e._v("55")]),t("br"),t("span",{staticClass:"line-number"},[e._v("56")]),t("br"),t("span",{staticClass:"line-number"},[e._v("57")]),t("br"),t("span",{staticClass:"line-number"},[e._v("58")]),t("br"),t("span",{staticClass:"line-number"},[e._v("59")]),t("br"),t("span",{staticClass:"line-number"},[e._v("60")]),t("br"),t("span",{staticClass:"line-number"},[e._v("61")]),t("br"),t("span",{staticClass:"line-number"},[e._v("62")]),t("br"),t("span",{staticClass:"line-number"},[e._v("63")]),t("br"),t("span",{staticClass:"line-number"},[e._v("64")]),t("br"),t("span",{staticClass:"line-number"},[e._v("65")]),t("br"),t("span",{staticClass:"line-number"},[e._v("66")]),t("br"),t("span",{staticClass:"line-number"},[e._v("67")]),t("br"),t("span",{staticClass:"line-number"},[e._v("68")]),t("br")])]),t("h3",{attrs:{id:"redis-cli-접속"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#redis-cli-접속"}},[e._v("#")]),e._v(" Redis Cli 접속")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker run -it --rm --network redis-cluster-net redis:5.0 redis-cli -c -h redis-c1-master -p 6379\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("h3",{attrs:{id:"cluster-정보-확인"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cluster-정보-확인"}},[e._v("#")]),e._v(" Cluster 정보 확인")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker run -i --rm --network redis-cluster-net redis:5.0 redis-cli --cluster info 172.18.0.2:6379\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("h2",{attrs:{id:"참고"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#참고"}},[e._v("#")]),e._v(" 참고")]),e._v(" "),t("ul",[t("li",[e._v("(docker 기반 redis 구축하기)[https://jaehun2841.github.io/2018/12/01/2018-12-01-docker-6/]")]),e._v(" "),t("li",[e._v("(Redis Cluster 구축 (redis cluster + predixy))[https://freesunny.tistory.com/56]")]),e._v(" "),t("li",[e._v("(Redis #.1 소개 및 설치)[https://rastalion.me/redis-1-%ec%86%8c%ea%b0%9c-%eb%b0%8f-%ec%84%a4%ec%b9%98/]")])])])}),[],!1,null,null,null);s.default=r.exports}}]);