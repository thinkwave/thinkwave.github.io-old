(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{527:function(s,n,a){"use strict";a.r(n);var e=a(4),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"querydsl과-spring-data-jpa"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#querydsl과-spring-data-jpa"}},[s._v("#")]),s._v(" Querydsl과 Spring Data JPA")]),s._v(" "),a("p",[a("code",[s._v("Spring Data Jpa")]),s._v("를 와 "),a("code",[s._v("Querydsl")]),s._v("을 함계 사용하는 방법")]),s._v(" "),a("h2",{attrs:{id:"spring-data-jpa-repository-상속"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#spring-data-jpa-repository-상속"}},[s._v("#")]),s._v(" Spring Data Jpa Repository 상속")]),s._v(" "),a("p",[a("code",[s._v("JpaRepository")]),s._v("를 상속 받아서 Repository를 만듭니다.")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("import java.util.List;\n\nimport org.springframework.data.domain.Page;\nimport org.springframework.data.domain.Pageable;\nimport org.springframework.data.jpa.repository.JpaRepository;\n\npublic interface PostRepository extends JpaRepository<Post, Long> {\n\n    Page<Post> findAllByOrderByIdDesc(Pageable pageable);\n    Page<Post> findAllByCategoryOrderByIdDesc(Pageable pageable, String category);    \n\n    List<Post> findTop3ByCategoryOrderByCreatedDateDesc(String category);\n    List<Post> findTop5ByCategoryOrderByCreatedDateDesc(String category);\n    \n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h2",{attrs:{id:"querydsl이-구현된-사용자-정의-repository-생성"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#querydsl이-구현된-사용자-정의-repository-생성"}},[s._v("#")]),s._v(" Querydsl이 구현된 사용자 정의 Repository 생성")]),s._v(" "),a("h3",{attrs:{id:"_1-사용자-정의-인터페이스-생성"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-사용자-정의-인터페이스-생성"}},[s._v("#")]),s._v(" 1. 사용자 정의 인터페이스 생성")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("import java.util.List;\nimport org.springframework.data.domain.Page;\nimport org.springframework.data.domain.Pageable;\n\npublic interface PostRepositoryCustom {\n    \n    List<Post> findByTitle(String title);\n    List<Post> findTopNByCategory(String category, long count, String[] openTypes, String[] statuses);\n    Page<Post> findByCategoryAndOpenTypeWithPaging(String category, String[] openTypes, String[] statuses, Pageable pageable);\n    Page<Post> findPostForAdmin(String category, String openTypes, String statuses, Pageable pageable);\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h3",{attrs:{id:"_2-사용자-정의-인터페이스-구현"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-사용자-정의-인터페이스-구현"}},[s._v("#")]),s._v(" 2. 사용자 정의 인터페이스 구현")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("import java.util.List;\nimport static com.exam.model.QPost.post;\nimport com.exam.model.Post;\nimport com.querydsl.core.QueryResults;\nimport com.querydsl.core.types.dsl.BooleanExpression;\nimport com.querydsl.jpa.impl.JPAQueryFactory;\nimport org.apache.commons.lang3.StringUtils;\nimport org.springframework.data.domain.Page;\nimport org.springframework.data.domain.PageImpl;\nimport org.springframework.data.domain.Pageable;\n\nimport lombok.RequiredArgsConstructor;\n\n\n@RequiredArgsConstructor\npublic class PostRepositoryImpl implements PostRepositoryCustom {\n    \n    private final JPAQueryFactory queryFactory;\n\n    public List<Post> findByTitle(String title) {\n        return queryFactory.selectFrom(post)\n                .where(post.title.like(title))\n                .fetch();\n    }\n\n    public List<Post> findTopNByCategory(String category, long count, String[] openTypes, String[] statuses) {\n        return queryFactory\n                .selectFrom(post)\n                .limit(count)\n                .where(\n                        post.category.like(category)\n                        .and(post.openType.in(openTypes))\n                        .and(post.status.in(statuses))\n                )\n                .orderBy(post.id.desc())\n                .fetch();\n    }\n\n\n    public Page<Post> findByCategoryAndOpenTypeWithPaging(String category, String[] openTypes, String[] statuses, Pageable pageable) {\n        \n        QueryResults<Post> results = queryFactory\n                .selectFrom(post)\n                .where(\n                        eqCategory(category),\n                        inOpenType(openTypes),\n                        inStatus(statuses)\n                        // post.category.like(category)\n                        // .and(post.openType.in(openTypes))\n                        // .and(post.status.in(statuses))\n                )\n                .orderBy(post.id.desc())\n                .offset(pageable.getOffset())\n                .limit(pageable.getPageSize())\n                .fetchResults();\n\n        return new PageImpl<>(results.getResults(),pageable,results.getTotal());\n    }\n\n    private BooleanExpression eqCategory(String category) {\n        if (StringUtils.isEmpty(category)) {\n            return null;\n        }\n        return post.category.eq(category);\n    }\n\n    private BooleanExpression inOpenType(String[] openTypes) {\n        if(openTypes == null || openTypes.length < 1) {\n            return null;\n        }\n        return post.openType.in(openTypes);\n    }\n\n    private BooleanExpression inStatus(String[] statuses) {\n        if(statuses == null || statuses.length < 1) {\n            return null;\n        }\n        return post.status.in(statuses);\n    }\n\n\n    @Override\n    public Page<Post> findPostForAdmin(String category, String openTypes, String status, Pageable pageable) {\n        QueryResults<Post> results = queryFactory\n                .selectFrom(post)\n                .where(\n                        eqOpenType(openTypes),\n                        eqStatus(status),\n                        eqCategory(category)\n                )\n                .orderBy(post.id.desc())\n                .offset(pageable.getOffset())\n                .limit(pageable.getPageSize())\n                .fetchResults();\n\n        return new PageImpl<>(results.getResults(),pageable,results.getTotal());\n    }\n\n    private BooleanExpression eqOpenType(String openType) {\n        if (StringUtils.isEmpty(openType)) {\n                return null;\n            }\n            return post.openType.eq(openType);\n    }\n\n    private BooleanExpression eqStatus(String status) {\n        if (StringUtils.isEmpty(status)) {\n                return null;\n            }\n            return post.status.eq(status);\n    }\n\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br"),a("span",{staticClass:"line-number"},[s._v("95")]),a("br"),a("span",{staticClass:"line-number"},[s._v("96")]),a("br"),a("span",{staticClass:"line-number"},[s._v("97")]),a("br"),a("span",{staticClass:"line-number"},[s._v("98")]),a("br"),a("span",{staticClass:"line-number"},[s._v("99")]),a("br"),a("span",{staticClass:"line-number"},[s._v("100")]),a("br"),a("span",{staticClass:"line-number"},[s._v("101")]),a("br"),a("span",{staticClass:"line-number"},[s._v("102")]),a("br"),a("span",{staticClass:"line-number"},[s._v("103")]),a("br"),a("span",{staticClass:"line-number"},[s._v("104")]),a("br"),a("span",{staticClass:"line-number"},[s._v("105")]),a("br"),a("span",{staticClass:"line-number"},[s._v("106")]),a("br"),a("span",{staticClass:"line-number"},[s._v("107")]),a("br"),a("span",{staticClass:"line-number"},[s._v("108")]),a("br"),a("span",{staticClass:"line-number"},[s._v("109")]),a("br"),a("span",{staticClass:"line-number"},[s._v("110")]),a("br"),a("span",{staticClass:"line-number"},[s._v("111")]),a("br"),a("span",{staticClass:"line-number"},[s._v("112")]),a("br"),a("span",{staticClass:"line-number"},[s._v("113")]),a("br")])]),a("h3",{attrs:{id:"_3-spring-data-jpa에-사용자-정의-인터페이스-상속"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-spring-data-jpa에-사용자-정의-인터페이스-상속"}},[s._v("#")]),s._v(" 3. Spring Data Jpa에 사용자 정의 인터페이스 상속")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("public interface PostRepository extends JpaRepository<Post, Long>, PostRepositoryCustom {\n\n    Page<Post> findAllByOrderByIdDesc(Pageable pageable);\n    Page<Post> findAllByCategoryOrderByIdDesc(Pageable pageable, String category);    \n\n    List<Post> findTop3ByCategoryOrderByCreatedDateDesc(String category);\n    List<Post> findTop5ByCategoryOrderByCreatedDateDesc(String category);\n    \n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])])])}),[],!1,null,null,null);n.default=t.exports}}]);